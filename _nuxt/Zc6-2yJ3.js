import{_ as h}from"./CR-T6FEM.js";import{_ as k}from"./Bjxnm9Od.js";import{a as v,_ as w}from"./Dh0Zgqt2.js";import{D as y,aa as B,ab as C,v as c,m as j,a5 as N,u as S,c as r,b as n,w as a,o as l,x as d,a as t,t as $,d as M}from"#entry";const R={class:"min-h-screen bg-gray-50 flex items-center justify-center px-6"},E={key:0,class:"text-center"},I={key:1,class:"text-center"},L={key:2,class:"text-center"},V={class:"text-red-600 mb-6"},H=y({__name:"callback",setup(D){const f=B(),_=C(),x=N(),s=c(!0),m=c(!1),i=c("");return j(async()=>{const o=f.query.token;if(!o){s.value=!1,i.value="未收到认证令牌";return}try{const e=await fetch(`${x.public.apiBase}/api/v1/auth/me`,{headers:{Authorization:`Bearer ${o}`}});if(!e.ok)throw new Error("验证令牌失败");const u=await e.json();localStorage.setItem("insightreader_token",o),localStorage.setItem("insightreader_user",JSON.stringify(u)),s.value=!1,m.value=!0,setTimeout(()=>{_.push("/")},1500)}catch(e){s.value=!1,i.value=e instanceof Error?e.message:"认证失败"}}),S({title:"登录中 - InsightReader"}),(o,e)=>{const u=h,p=k,g=w,b=v;return l(),r("div",R,[n(b,{class:"w-full max-w-md"},{default:a(()=>[n(g,{class:"p-8"},{default:a(()=>[d(s)?(l(),r("div",E,[...e[0]||(e[0]=[t("div",{class:"animate-spin h-12 w-12 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"},null,-1),t("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"正在登录...",-1),t("p",{class:"text-gray-600"},"正在完成认证",-1)])])):d(m)?(l(),r("div",I,[...e[1]||(e[1]=[t("div",{class:"bg-green-100 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-4"},[t("svg",{class:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1),t("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"登录成功！",-1),t("p",{class:"text-gray-600 mb-6"},"正在跳转...",-1)])])):(l(),r("div",L,[e[3]||(e[3]=t("div",{class:"bg-red-100 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-4"},[t("svg",{class:"h-8 w-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),e[4]||(e[4]=t("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"登录失败",-1)),t("p",V,$(d(i)),1),n(p,{to:"/login"},{default:a(()=>[n(u,null,{default:a(()=>[...e[2]||(e[2]=[M("返回登录",-1)])]),_:1})]),_:1})]))]),_:1})]),_:1})])}}});export{H as default};
