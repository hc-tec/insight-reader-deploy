import{_ as J}from"./DfW_KrGd.js";import{_ as W}from"./C3LQ35JC.js";import{a3 as X,v as h,r as q,D as Y,l as O,e as Z,m as ee,u as te,c as a,a as t,K as _,b as $,x as l,a4 as V,w as B,a2 as T,t as u,M as S,N as R,a0 as H,a1 as N,$ as oe,o as n,d as g,_ as se}from"#entry";import{a as F}from"./Cd2Mrs8-.js";import"./CR-T6FEM.js";const re=()=>{const U=X(),{token:M}=F(),x=U.public.apiBase,c=h(!1),i=h(null),p=()=>{if(!M.value)throw new Error("需要登录");return{Authorization:`Bearer ${M.value}`}},z=async()=>{c.value=!0,i.value=null;try{const s=await $fetch("/api/v1/admin/demo/articles",{baseURL:x,method:"GET",headers:p()});return console.log("[Admin] 获取示例文章列表成功:",s.total,"篇"),s.articles}catch(s){return console.error("[Admin] 获取示例文章列表失败:",s),s.statusCode===403?i.value="需要管理员权限":i.value=s.data?.detail||"获取失败",null}finally{c.value=!1}},D=async()=>{c.value=!0,i.value=null;try{const s=await $fetch("/api/v1/articles",{baseURL:x,method:"GET",headers:p(),query:{limit:100,offset:0}});return console.log("[Admin] 获取所有文章成功:",s.total,"篇"),s.articles.map(d=>({id:d.id,title:d.title,author:d.author,word_count:d.word_count,created_at:d.created_at,is_demo:!1,has_analysis:!1,has_meta_analysis:!1}))}catch(s){return console.error("[Admin] 获取文章列表失败:",s),i.value=s.data?.detail||"获取失败",null}finally{c.value=!1}},v=async(s,d={})=>{c.value=!0,i.value=null;try{return await $fetch(`/api/v1/admin/demo/articles/${s}/mark`,{baseURL:x,method:"POST",headers:p(),body:{demo_order:d.demo_order}}),console.log("[Admin] 文章已标记为示例:",s),!0}catch(f){return console.error("[Admin] 标记失败:",f),i.value=f.data?.detail||"标记失败",!1}finally{c.value=!1}},m=async s=>{c.value=!0,i.value=null;try{return await $fetch(`/api/v1/admin/demo/articles/${s}/unmark`,{baseURL:x,method:"DELETE",headers:p()}),console.log("[Admin] 已取消示例标记:",s),!0}catch(d){return console.error("[Admin] 取消标记失败:",d),i.value=d.data?.detail||"操作失败",!1}finally{c.value=!1}},b=async(s,d)=>{c.value=!0,i.value=null;try{return await $fetch(`/api/v1/admin/demo/articles/${s}/order`,{baseURL:x,method:"PUT",headers:p(),query:{order:d}}),console.log("[Admin] 顺序已更新:",s,"→",d),!0}catch(f){return console.error("[Admin] 更新顺序失败:",f),i.value=f.data?.detail||"更新失败",!1}finally{c.value=!1}};return{loading:q(c),error:q(i),getDemoArticles:z,getAllArticles:D,markAsDemo:v,unmarkDemo:m,updateOrder:b}},ae={class:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-zinc-50 relative overflow-hidden"},le={class:"relative z-10"},ne={key:0,class:"max-w-7xl mx-auto px-6 py-20"},de={class:"max-w-md mx-auto bg-white/70 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-8 shadow-sm text-center"},ie={key:1},ce={class:"max-w-7xl mx-auto px-6 pt-8 pb-6"},ue={class:"flex items-center justify-between mb-6"},me={class:"bg-white/70 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-2 flex gap-2 shadow-sm"},fe={class:"max-w-7xl mx-auto px-6 pb-12"},he={key:0,class:"flex items-center justify-center py-20"},xe={key:1,class:"py-20 flex flex-col items-center justify-center"},pe={class:"text-gray-600 mb-6"},ve={key:2},ge={key:0,class:"py-20 flex flex-col items-center justify-center"},be={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ye={class:"flex items-start justify-between mb-3"},we={class:"flex items-center gap-2"},_e={class:"px-3 py-1 bg-gradient-to-r from-amber-500 to-orange-600 text-white text-sm font-bold rounded-full"},ke={key:0,class:"px-3 py-1 bg-teal-100 text-teal-700 text-xs rounded-full font-medium"},Ae={key:1,class:"px-3 py-1 bg-slate-100 text-slate-700 text-xs rounded-full font-medium"},Ce=["onClick"],je={class:"text-xl font-semibold text-gray-900 mb-2"},Me={key:0,class:"text-sm text-gray-600 mb-3"},$e={class:"flex items-center gap-4 text-sm text-gray-600 mb-4"},ze={class:"flex items-center gap-1"},De={class:"flex items-center gap-2"},Ve=["onUpdate:modelValue","onChange"],Be={key:3},Te={class:"mb-6"},He={key:0,class:"py-20 flex flex-col items-center justify-center"},Ne={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ue={class:"text-xl font-semibold text-gray-900 mb-2"},Le={class:"flex items-center gap-4 text-sm text-gray-600 mb-4"},Ee={key:0,class:"flex items-center gap-1"},qe={class:"flex items-center gap-1"},Oe={class:"flex items-center gap-1"},Se={class:"flex items-center gap-2"},Re=["onUpdate:modelValue"],Fe=["onClick"],Ge=Y({__name:"demo",setup(U){const{user:M}=F(),{getDemoArticles:x,getAllArticles:c,markAsDemo:i,unmarkDemo:p,updateOrder:z,loading:D,error:v}=re(),m=h("demo"),b=h([]),s=h([]),d=h(""),f=h({}),k=h({show:!1,message:"",type:"success"}),G=O(()=>[...b.value].sort((r,e)=>{const C=r.demo_order??999,j=e.demo_order??999;return C-j})),L=O(()=>{if(!d.value)return s.value;const r=d.value.toLowerCase();return s.value.filter(e=>e.title.toLowerCase().includes(r))}),y=(r,e="success")=>{k.value={show:!0,message:r,type:e},setTimeout(()=>{k.value.show=!1},3e3)},P=r=>new Date(r).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"}),E=r=>r>=1e4?`${(r/1e4).toFixed(1)}万`:r.toString(),A=async()=>{if(m.value==="demo"){const r=await x();r&&(b.value=r)}else{const r=await c();r&&(s.value=r)}},K=async(r,e)=>{await i(r,{demo_order:e})?(y("已标记为示例文章","success"),await A()):y(v.value||"标记失败","error")},Q=async r=>{if(!confirm("确定要取消示例标记吗？"))return;await p(r)?(y("已取消示例标记","success"),await A()):y(v.value||"操作失败","error")},I=async(r,e)=>{if(!e)return;await z(r,e)?y("顺序已更新","success"):y(v.value||"更新失败","error")};return Z(m,()=>{A()}),ee(()=>{A()}),te({title:"示例文章管理 - InsightReader"}),(r,e)=>{const C=J,j=W;return n(),a("div",ae,[e[18]||(e[18]=t("div",{class:"fixed inset-0 overflow-hidden pointer-events-none z-0"},[t("div",{class:"absolute -top-40 -right-40 w-96 h-96 bg-emerald-400/10 rounded-full blur-3xl"}),t("div",{class:"absolute top-1/3 -left-40 w-80 h-80 bg-teal-400/10 rounded-full blur-3xl"}),t("div",{class:"absolute bottom-20 right-1/3 w-64 h-64 bg-slate-400/10 rounded-full blur-3xl"})],-1)),t("div",le,[$(C),l(M)?(n(),a("div",ie,[t("div",ce,[t("div",ue,[e[6]||(e[6]=t("div",null,[t("h1",{class:"text-4xl font-bold bg-gradient-to-r from-slate-800 via-slate-700 to-zinc-700 bg-clip-text text-transparent mb-2"}," 示例文章管理 "),t("p",{class:"text-gray-600 text-lg"}," 管理员专用页面 ")],-1)),$(j,{to:"/",target:"_blank",class:"px-6 py-3 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-xl hover:from-emerald-700 hover:to-teal-700 transition-all shadow-md font-semibold whitespace-nowrap"},{default:B(()=>[...e[5]||(e[5]=[g(" 查看首页示例文章 → ",-1)])]),_:1})]),t("div",me,[t("button",{onClick:e[0]||(e[0]=o=>m.value="demo"),class:T(["flex-1 px-6 py-3 rounded-xl font-semibold transition-all",l(m)==="demo"?"bg-gradient-to-r from-emerald-600 to-teal-600 text-white shadow-md":"text-gray-600 hover:bg-gray-50"])}," 已标记的示例 ("+u(l(b).length)+") ",3),t("button",{onClick:e[1]||(e[1]=o=>m.value="all"),class:T(["flex-1 px-6 py-3 rounded-xl font-semibold transition-all",l(m)==="all"?"bg-gradient-to-r from-emerald-600 to-teal-600 text-white shadow-md":"text-gray-600 hover:bg-gray-50"])}," 所有文章 ",2)])]),t("div",fe,[l(D)?(n(),a("div",he,[...e[7]||(e[7]=[t("div",{class:"animate-spin h-12 w-12 border-4 border-purple-600 border-t-transparent rounded-full"},null,-1),t("span",{class:"ml-4 text-gray-600"},"加载中...",-1)])])):l(v)?(n(),a("div",xe,[e[8]||(e[8]=t("div",{class:"w-24 h-24 bg-gradient-to-br from-red-100 to-pink-100 rounded-2xl flex items-center justify-center mb-6"},[t("svg",{class:"w-12 h-12 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e[9]||(e[9]=t("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"加载失败",-1)),t("p",pe,u(l(v)),1),t("button",{onClick:A,class:"px-6 py-3 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-xl hover:from-emerald-700 hover:to-teal-700 transition-all shadow-md"}," 重试 ")])):l(m)==="demo"?(n(),a("div",ve,[l(b).length===0?(n(),a("div",ge,[...e[10]||(e[10]=[V('<div class="w-24 h-24 bg-gradient-to-br from-emerald-100 to-teal-100 rounded-2xl flex items-center justify-center mb-6" data-v-c2fc6d5f><svg class="w-12 h-12 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c2fc6d5f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" data-v-c2fc6d5f></path></svg></div><h3 class="text-xl font-semibold text-gray-900 mb-2" data-v-c2fc6d5f>暂无示例文章</h3><p class="text-gray-600 mb-6" data-v-c2fc6d5f>切换到&quot;所有文章&quot;标签，选择文章标记为示例</p>',3)])])):(n(),a("div",be,[(n(!0),a(S,null,R(l(G),o=>(n(),a("div",{key:o.id,class:"group bg-white/70 backdrop-blur-xl border-2 border-amber-200/50 rounded-2xl p-6 shadow-sm hover:shadow-lg transition-all"},[t("div",ye,[t("div",we,[t("span",_e," #"+u(o.demo_order||"?"),1),o.has_analysis?(n(),a("span",ke," 完整分析 ")):_("",!0),o.has_meta_analysis?(n(),a("span",Ae," 元视角 ")):_("",!0)]),t("button",{onClick:w=>Q(o.id),class:"p-2 rounded-lg hover:bg-red-50 transition-colors",title:"取消示例标记"},[...e[11]||(e[11]=[t("svg",{class:"w-5 h-5 text-gray-400 hover:text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Ce)]),t("h3",je,u(o.title),1),o.author?(n(),a("p",Me," 作者: "+u(o.author),1)):_("",!0),t("div",$e,[t("span",ze,[e[12]||(e[12]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),g(" "+u(E(o.word_count||0))+" 字 ",1)])]),t("div",De,[H(t("input",{"onUpdate:modelValue":w=>o.demo_order=w,type:"number",min:"1",placeholder:"展示顺序",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500",onChange:w=>I(o.id,o.demo_order)},null,40,Ve),[[N,o.demo_order,void 0,{number:!0}]]),$(j,{to:`/?articleId=${o.id}`,target:"_blank",class:"px-4 py-2 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-lg text-sm font-medium hover:from-emerald-700 hover:to-teal-700 transition-all"},{default:B(()=>[...e[13]||(e[13]=[g(" 预览 ",-1)])]),_:1},8,["to"])])]))),128))]))])):l(m)==="all"?(n(),a("div",Be,[t("div",Te,[H(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>oe(d)?d.value=o:null),type:"text",placeholder:"搜索文章标题...",class:"w-full px-6 py-4 bg-white/70 backdrop-blur-xl border border-gray-200/50 rounded-2xl focus:outline-none focus:ring-2 focus:ring-emerald-500 text-lg shadow-sm"},null,512),[[N,l(d)]])]),l(L).length===0?(n(),a("div",He,[...e[14]||(e[14]=[V('<div class="w-24 h-24 bg-gradient-to-br from-emerald-100 to-teal-100 rounded-2xl flex items-center justify-center mb-6" data-v-c2fc6d5f><svg class="w-12 h-12 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c2fc6d5f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-c2fc6d5f></path></svg></div><h3 class="text-xl font-semibold text-gray-900 mb-2" data-v-c2fc6d5f>没有找到文章</h3><p class="text-gray-600" data-v-c2fc6d5f>尝试调整搜索关键词</p>',3)])])):(n(),a("div",Ne,[(n(!0),a(S,null,R(l(L),o=>(n(),a("div",{key:o.id,class:"group bg-white/70 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-6 shadow-sm hover:shadow-lg transition-all"},[t("h3",Ue,u(o.title),1),t("div",Le,[o.author?(n(),a("span",Ee,[e[15]||(e[15]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),g(" "+u(o.author),1)])):_("",!0),t("span",qe,[e[16]||(e[16]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),g(" "+u(E(o.word_count||0))+" 字 ",1)]),t("span",Oe,[e[17]||(e[17]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),g(" "+u(P(o.created_at)),1)])]),t("div",Se,[H(t("input",{"onUpdate:modelValue":w=>l(f)[o.id]=w,type:"number",min:"1",placeholder:"展示顺序（可选）",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500"},null,8,Re),[[N,l(f)[o.id],void 0,{number:!0}]]),t("button",{onClick:w=>K(o.id,l(f)[o.id]),class:"px-4 py-2 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-lg text-sm font-medium hover:from-emerald-700 hover:to-teal-700 transition-all whitespace-nowrap"}," 标记为示例 ",8,Fe)])]))),128))]))])):_("",!0)])])):(n(),a("div",ne,[t("div",de,[e[4]||(e[4]=V('<div class="w-20 h-20 bg-gradient-to-br from-emerald-100 to-teal-100 rounded-2xl flex items-center justify-center mx-auto mb-6" data-v-c2fc6d5f><svg class="w-10 h-10 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c2fc6d5f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" data-v-c2fc6d5f></path></svg></div><h2 class="text-2xl font-bold text-gray-900 mb-2" data-v-c2fc6d5f>需要登录</h2><p class="text-gray-600 mb-6" data-v-c2fc6d5f>请先登录才能访问管理员页面</p>',3)),$(j,{to:"/login",class:"inline-block px-6 py-3 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-xl hover:from-emerald-700 hover:to-teal-700 transition-all shadow-md font-semibold"},{default:B(()=>[...e[3]||(e[3]=[g(" 前往登录 ",-1)])]),_:1})])]))]),l(k).show?(n(),a("div",{key:0,class:T(["fixed bottom-8 right-8 px-6 py-4 bg-white rounded-xl shadow-lg border-l-4 font-semibold z-50 animate-slide-in",l(k).type==="success"?"border-green-500 text-green-700":"border-red-500 text-red-700"])},u(l(k).message),3)):_("",!0)])}}}),We=se(Ge,[["__scopeId","data-v-c2fc6d5f"]]);export{We as default};
