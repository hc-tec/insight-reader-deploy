import{_ as F}from"./DfW_KrGd.js";import{_ as P}from"./CR-T6FEM.js";import{_ as q}from"./C3LQ35JC.js";import{_ as G,a as J}from"./Dh0Zgqt2.js";import{D as O,aa as Q,v as _,m as W,u as X,c,b as l,a as t,a0 as j,a1 as Y,x as s,$,ab as Z,w as r,t as o,K as f,M as tt,N as et,a5 as st,o as i,d as g,H as nt,a2 as D,S as ot,_ as at}from"#entry";import{u as lt,m as rt}from"./BWKh7jvb.js";import{a as it}from"./Cd2Mrs8-.js";const dt={class:"min-h-screen bg-gray-50"},ct={class:"max-w-6xl mx-auto px-6 py-8"},ut={class:"mb-6 flex gap-4"},pt={key:0,class:"flex items-center justify-center py-20"},mt={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},xt={class:"text-red-600"},_t={key:2,class:"text-center py-20"},ft={key:3,class:"space-y-4"},vt={class:"flex items-center justify-between mb-3"},gt={class:"flex items-center gap-3"},ht={class:"text-sm text-gray-500"},yt={class:"font-medium text-gray-900 mb-3 line-clamp-2"},bt={class:"text-sm text-gray-600 mb-3 line-clamp-3"},kt={key:0,class:"text-xs text-gray-500"},wt={key:0,class:"text-center py-6"},Ct={class:"text-center text-sm text-gray-500 py-4"},Mt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-6"},zt={class:"flex justify-end mb-4"},Bt={class:"mb-4 pb-4 border-b"},Lt={class:"flex items-center gap-3 mb-2"},Vt={class:"text-sm text-gray-500"},jt={class:"font-medium text-gray-900"},$t={key:0,class:"text-sm text-gray-500 mt-1"},Dt=["innerHTML"],h=20,It=O({__name:"collections",setup(Nt){const I=Q(),{isAuthenticated:N}=it(),{collections:x,total:y,isLoading:b,error:k,fetchCollections:w,deleteCollection:H}=lt(),u=_(""),p=_(""),d=_(null),v=_(0);W(async()=>{if(!N.value){I.push("/login");return}await C()});const C=async()=>{v.value=0,await w({skip:0,limit:h,intent:p.value||void 0,search:u.value||void 0})},S=async()=>{v.value++,await w({skip:v.value*h,limit:h,intent:p.value||void 0,search:u.value||void 0})},T=a=>{d.value=a},A=async a=>{if(!confirm("确定要删除这条收藏吗？"))return;const e=await H(a);e.success||alert(e.error||"删除失败")},R=a=>rt(a),M=a=>new Date(a).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),z=a=>({explain:"解释",analyze:"分析",counter:"反方"})[a],B=a=>({explain:"bg-blue-50 text-blue-600",analyze:"bg-green-50 text-green-600",counter:"bg-purple-50 text-purple-600"})[a];return X({title:"我的收藏 - InsightReader",meta:[{name:"description",content:"查看和管理你的洞察收藏"}]}),(a,e)=>{const K=F,m=P,U=q,L=G,V=J;return i(),c("div",dt,[l(K),t("div",ct,[e[12]||(e[12]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"我的收藏"),t("p",{class:"text-gray-600"},"管理你收藏的洞察卡片")],-1)),t("div",ut,[j(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>$(u)?u.value=n:null),type:"text",placeholder:"搜索收藏...",class:"flex-1 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[Y,s(u)]]),j(t("select",{"onUpdate:modelValue":e[1]||(e[1]=n=>$(p)?p.value=n:null),class:"px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[3]||(e[3]=[t("option",{value:""},"全部类型",-1),t("option",{value:"explain"},"解释",-1),t("option",{value:"analyze"},"分析",-1),t("option",{value:"counter"},"反方",-1)])],512),[[Z,s(p)]]),l(m,{onClick:C},{default:r(()=>[...e[4]||(e[4]=[t("svg",{class:"mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),g(" 搜索 ",-1)])]),_:1})]),s(b)?(i(),c("div",pt,[...e[5]||(e[5]=[t("div",{class:"animate-spin h-8 w-8 border-4 border-blue-600 border-t-transparent rounded-full"},null,-1),t("span",{class:"ml-3 text-gray-600"},"加载中...",-1)])])):s(k)?(i(),c("div",mt,[t("p",xt,o(s(k)),1)])):s(x).length===0?(i(),c("div",_t,[e[7]||(e[7]=t("svg",{class:"w-20 h-20 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})],-1)),e[8]||(e[8]=t("p",{class:"text-xl text-gray-600 mb-2"},"还没有收藏",-1)),e[9]||(e[9]=t("p",{class:"text-gray-500 mb-6"},"开始阅读并收藏有价值的洞察吧",-1)),l(U,{to:"/"},{default:r(()=>[l(m,null,{default:r(()=>[...e[6]||(e[6]=[g("开始阅读",-1)])]),_:1})]),_:1})])):(i(),c("div",ft,[(i(!0),c(tt,null,et(s(x),n=>(i(),nt(V,{key:n.id,class:"hover:shadow-lg transition-shadow cursor-pointer",onClick:E=>T(n)},{default:r(()=>[l(L,{class:"p-6"},{default:r(()=>[t("div",vt,[t("div",gt,[t("span",{class:D(["px-3 py-1 text-xs font-medium rounded-full",B(n.intent)])},o(z(n.intent)),3),t("span",ht,o(M(n.created_at)),1)]),l(m,{variant:"ghost",size:"sm",onClick:ot(E=>A(n.id),["stop"]),class:"text-red-600 hover:text-red-700"},{default:r(()=>[...e[10]||(e[10]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])]),_:1},8,["onClick"])]),t("p",yt,' "'+o(n.selected_text)+'" ',1),t("p",bt,o(n.insight.substring(0,200))+o(n.insight.length>200?"...":""),1),n.article_title?(i(),c("div",kt," 来自: "+o(n.article_title),1)):f("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),s(y)>s(x).length?(i(),c("div",wt,[l(m,{variant:"outline",onClick:S,disabled:s(b)},{default:r(()=>[...e[11]||(e[11]=[g(" 加载更多 ",-1)])]),_:1},8,["disabled"])])):f("",!0),t("div",Ct," 已显示 "+o(s(x).length)+" / "+o(s(y))+" 条收藏 ",1)]))]),l(st,{name:"fade"},{default:r(()=>[s(d)?(i(),c("div",Mt,[l(V,{class:"w-full max-w-3xl max-h-[90vh] overflow-y-auto"},{default:r(()=>[l(L,{class:"p-6"},{default:r(()=>[t("div",zt,[l(m,{variant:"ghost",size:"sm",onClick:e[2]||(e[2]=n=>d.value=null)},{default:r(()=>[...e[13]||(e[13]=[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),_:1})]),t("div",Bt,[t("div",Lt,[t("span",{class:D(["px-3 py-1 text-xs font-medium rounded-full",B(s(d).intent)])},o(z(s(d).intent)),3),t("span",Vt,o(M(s(d).created_at)),1)]),t("p",jt,'"'+o(s(d).selected_text)+'"',1),s(d).article_title?(i(),c("p",$t," 来自: "+o(s(d).article_title),1)):f("",!0)]),t("div",{class:"prose prose-sm max-w-none",innerHTML:R(s(d).insight)},null,8,Dt)]),_:1})]),_:1})])):f("",!0)]),_:1})])}}}),Et=at(It,[["__scopeId","data-v-d8b74bf3"]]);export{Et as default};
