import{_ as j}from"./DfW_KrGd.js";import{_ as B}from"./C3LQ35JC.js";import{D as $,aa as z,v as m,m as A,u as V,c as n,a as t,b,K as w,x as l,t as r,M as N,N as D,a4 as S,w as L,a3 as H,o as i,d as c,S as E}from"#entry";import{a as T}from"./Cd2Mrs8-.js";import"./CR-T6FEM.js";const R={class:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-zinc-50 relative overflow-hidden"},W={class:"relative z-10"},F={class:"max-w-7xl mx-auto px-6 pt-8 pb-6"},q={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8"},K={class:"bg-white/70 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-6 shadow-sm"},G={class:"flex items-center gap-4"},I={class:"text-3xl font-bold bg-gradient-to-r from-purple-600 to-indigo-600 bg-clip-text text-transparent"},J={class:"bg-white/70 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-6 shadow-sm"},O={class:"flex items-center gap-4"},P={class:"text-3xl font-bold bg-gradient-to-r from-violet-600 to-purple-600 bg-clip-text text-transparent"},Q={class:"bg-white/70 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-6 shadow-sm"},U={class:"flex items-center gap-4"},X={class:"text-3xl font-bold bg-gradient-to-r from-indigo-600 to-blue-600 bg-clip-text text-transparent"},Y={class:"max-w-7xl mx-auto px-6 pb-12"},Z={key:0,class:"flex items-center justify-center py-20"},tt={key:1,class:"space-y-4"},et=["onClick"],ot={class:"flex items-start justify-between"},st={class:"flex-1"},rt={class:"text-xl font-semibold text-gray-900 mb-2 group-hover:text-purple-600 transition-colors"},nt={class:"flex items-center gap-4 text-sm text-gray-600 mb-3"},it={class:"flex items-center gap-1"},lt={class:"flex items-center gap-1"},at={class:"flex items-center gap-1"},dt={class:"flex items-center gap-4 text-xs text-gray-500"},ct={class:"flex flex-col items-end gap-2"},ut={key:0,class:"px-3 py-1 bg-purple-100 text-purple-700 text-xs rounded-full"},pt=["onClick"],xt={key:2,class:"py-20 flex flex-col items-center justify-center"},wt=$({__name:"history",setup(ht){const _=z(),{isAuthenticated:y}=T(),u=H(),p=m([]),x=m(!0),a=m({total:0,withMetaAnalysis:0,totalWords:0}),g=async()=>{x.value=!0;try{const o=await $fetch(`${u.public.apiBase}/api/v1/articles`,{params:{limit:50}});p.value=o.articles,a.value={total:o.total,withMetaAnalysis:o.articles.filter(e=>e.has_meta_analysis).length,totalWords:o.articles.reduce((e,d)=>e+(d.word_count||0),0)}}catch(o){console.error("❌ 获取文章列表失败:",o)}finally{x.value=!1}},k=async o=>{try{const e=await $fetch(`${u.public.apiBase}/api/v1/articles/${o}`);_.push({path:"/",query:{articleId:o}})}catch(e){console.error("❌ 获取文章失败:",e)}},C=async o=>{if(confirm("确定要删除这篇文章吗？这将同时删除相关的元视角分析。"))try{await $fetch(`${u.public.apiBase}/api/v1/articles/${o}`,{method:"DELETE"}),await g()}catch(e){console.error("❌ 删除文章失败:",e)}},v=o=>{const e=new Date(o),h=new Date().getTime()-e.getTime(),s=Math.floor(h/(1e3*60*60*24));return s===0?"今天":s===1?"昨天":s<7?`${s}天前`:s<30?`${Math.floor(s/7)}周前`:e.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})},f=o=>o>=1e4?`${(o/1e4).toFixed(1)}万`:o.toString();return A(async()=>{y.value,await g()}),V({title:"阅读历史 - InsightReader"}),(o,e)=>{const d=j,h=B;return i(),n("div",R,[e[14]||(e[14]=t("div",{class:"fixed inset-0 overflow-hidden pointer-events-none z-0"},[t("div",{class:"absolute -top-40 -right-40 w-96 h-96 bg-purple-400/10 rounded-full blur-3xl"}),t("div",{class:"absolute top-1/3 -left-40 w-80 h-80 bg-indigo-400/10 rounded-full blur-3xl"}),t("div",{class:"absolute bottom-20 right-1/3 w-64 h-64 bg-violet-400/10 rounded-full blur-3xl"})],-1)),t("div",W,[b(d),t("div",F,[e[6]||(e[6]=t("div",{class:"mb-6"},[t("h1",{class:"text-4xl font-bold bg-gradient-to-r from-purple-800 via-violet-700 to-indigo-700 bg-clip-text text-transparent mb-2"}," 阅读历史 "),t("p",{class:"text-gray-600 text-lg"}," 查看你曾经阅读过的文章，随时重温精彩内容 ")],-1)),l(a)?(i(),n("div",q,[t("div",K,[t("div",G,[e[1]||(e[1]=t("div",{class:"w-14 h-14 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-xl flex items-center justify-center"},[t("svg",{class:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})])],-1)),t("div",null,[t("div",I,r(l(a).total),1),e[0]||(e[0]=t("div",{class:"text-sm text-gray-600 mt-0.5"},"总阅读篇数",-1))])])]),t("div",J,[t("div",O,[e[3]||(e[3]=t("div",{class:"w-14 h-14 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl flex items-center justify-center"},[t("svg",{class:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})])],-1)),t("div",null,[t("div",P,r(l(a).withMetaAnalysis),1),e[2]||(e[2]=t("div",{class:"text-sm text-gray-600 mt-0.5"},"元视角分析",-1))])])]),t("div",Q,[t("div",U,[e[5]||(e[5]=t("div",{class:"w-14 h-14 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-xl flex items-center justify-center"},[t("svg",{class:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),t("div",null,[t("div",X,r(f(l(a).totalWords)),1),e[4]||(e[4]=t("div",{class:"text-sm text-gray-600 mt-0.5"},"累计字数",-1))])])])])):w("",!0)]),t("div",Y,[l(x)?(i(),n("div",Z,[...e[7]||(e[7]=[t("div",{class:"animate-spin h-12 w-12 border-4 border-purple-600 border-t-transparent rounded-full"},null,-1),t("span",{class:"ml-4 text-gray-600"},"加载中...",-1)])])):l(p).length>0?(i(),n("div",tt,[(i(!0),n(N,null,D(l(p),s=>(i(),n("div",{key:s.id,class:"group bg-white/70 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-6 shadow-sm hover:shadow-lg transition-all hover:-translate-y-1 cursor-pointer",onClick:M=>k(s.id)},[t("div",ot,[t("div",st,[t("h3",rt,r(s.title),1),t("div",nt,[t("span",it,[e[8]||(e[8]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),c(" "+r(s.author||"未知作者"),1)]),t("span",lt,[e[9]||(e[9]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),c(" "+r(f(s.word_count))+" 字 ",1)]),t("span",at,[e[10]||(e[10]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),c(" 阅读 "+r(s.read_count)+" 次 ",1)])]),t("div",dt,[t("span",null,"首次阅读: "+r(v(s.created_at)),1),t("span",null,"最后阅读: "+r(v(s.last_read_at)),1)])]),t("div",ct,[s.has_meta_analysis?(i(),n("span",ut," 元视角 ")):w("",!0),t("button",{onClick:E(M=>C(s.id),["stop"]),class:"p-2 rounded-lg hover:bg-red-50 transition-colors",title:"删除"},[...e[11]||(e[11]=[t("svg",{class:"w-5 h-5 text-gray-400 hover:text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,pt)])])],8,et))),128))])):(i(),n("div",xt,[e[13]||(e[13]=S('<div class="w-24 h-24 bg-gradient-to-br from-purple-100 to-indigo-100 rounded-2xl flex items-center justify-center mb-6"><svg class="w-12 h-12 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg></div><h3 class="text-xl font-semibold text-gray-900 mb-2">还没有阅读记录</h3><p class="text-gray-600 mb-6">开始阅读文章，这里将显示你的历史记录</p>',3)),b(h,{to:"/",class:"px-6 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-xl hover:from-purple-700 hover:to-indigo-700 transition-all shadow-md"},{default:L(()=>[...e[12]||(e[12]=[c(" 开始阅读 ",-1)])]),_:1})]))])])])}}});export{wt as default};
