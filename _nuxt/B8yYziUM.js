import{_ as v}from"./CR-T6FEM.js";import{_ as k}from"./C3LQ35JC.js";import{a as h,_ as y}from"./Dh0Zgqt2.js";import{D as w,a9 as C,aa as B,v as u,m as S,a3 as j,u as N,c as o,b as n,w as r,o as a,x as c,a as t,t as $,d as I}from"#entry";const M={class:"min-h-screen bg-gray-50 flex items-center justify-center px-6"},R={key:0,class:"text-center"},L={key:1,class:"text-center"},V={key:2,class:"text-center"},D={class:"text-red-600 mb-6"},O=w({__name:"callback",setup(E){const m=C(),f=B(),_=j(),s=u(!0),d=u(!1),l=u("");return S(async()=>{const i=m.query.token;if(!i){s.value=!1,l.value="未收到认证令牌";return}try{localStorage.setItem("insightreader_token",i);const e=await $fetch(`${_.public.apiBase}/api/v1/auth/me`);localStorage.setItem("insightreader_user",JSON.stringify(e)),s.value=!1,d.value=!0,setTimeout(()=>{f.push("/")},1500)}catch(e){s.value=!1,l.value=e instanceof Error?e.message:"认证失败",localStorage.removeItem("insightreader_token")}}),N({title:"登录中 - InsightReader"}),(i,e)=>{const x=v,p=k,g=y,b=h;return a(),o("div",M,[n(b,{class:"w-full max-w-md"},{default:r(()=>[n(g,{class:"p-8"},{default:r(()=>[c(s)?(a(),o("div",R,[...e[0]||(e[0]=[t("div",{class:"animate-spin h-12 w-12 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"},null,-1),t("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"正在登录...",-1),t("p",{class:"text-gray-600"},"正在完成认证",-1)])])):c(d)?(a(),o("div",L,[...e[1]||(e[1]=[t("div",{class:"bg-green-100 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-4"},[t("svg",{class:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1),t("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"登录成功！",-1),t("p",{class:"text-gray-600 mb-6"},"正在跳转...",-1)])])):(a(),o("div",V,[e[3]||(e[3]=t("div",{class:"bg-red-100 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-4"},[t("svg",{class:"h-8 w-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),e[4]||(e[4]=t("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"登录失败",-1)),t("p",D,$(c(l)),1),n(p,{to:"/login"},{default:r(()=>[n(x,null,{default:r(()=>[...e[2]||(e[2]=[I("返回登录",-1)])]),_:1})]),_:1})]))]),_:1})]),_:1})])}}});export{O as default};
